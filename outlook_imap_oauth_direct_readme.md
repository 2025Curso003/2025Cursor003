# Outlook 直接访问邮件获取工具

这个简化版的Python脚本允许您使用已知的认证信息（邮箱账号、密码、clientId和刷新令牌）直接获取Outlook邮箱中的最新邮件，无需交互式授权流程。

## 功能特点

- 支持两种认证方式：OAuth和密码登录（优先使用OAuth，失败后尝试密码）
- 自动尝试刷新访问令牌
- 获取邮箱中的最新邮件，支持解析邮件主题、发件人、日期和正文内容
- 可选是否将邮件标记为已读
- 简单直观的输出显示

## 使用方法

1. 确保已安装必要的Python库：
   ```bash
   pip install requests
   ```

2. 编辑脚本中的认证信息：
   - 打开 `outlook_imap_oauth_direct.py` 文件
   - 找到 `main()` 函数中的配置部分
   - 替换以下信息为您自己的：
     ```python
     username = "FrancoWilliam4481@outlook.com"  # 替换为您的Outlook邮箱地址
     password = "gmcm98022"  # 替换为您的密码
     client_id = "9e5f94bc-e8a4-4e73-b8be-63364c29d753"  # 替换为您的应用ID
     refresh_token = "..."  # 替换为您的刷新令牌
     mark_as_read = False  # 如果希望将邮件标记为已读，改为True
     ```

3. 运行脚本：
   ```bash
   python outlook_imap_oauth_direct.py
   ```

## 工作原理

1. 脚本首先尝试使用OAuth方式获取邮件：
   - 使用刷新令牌获取新的访问令牌
   - 使用访问令牌进行IMAP认证
   - 获取并解析最新邮件

2. 如果OAuth方式失败，脚本会自动尝试使用密码方式：
   - 使用常规IMAP密码登录
   - 获取并解析最新邮件

3. 无论使用哪种方式，脚本都会显示：
   - 邮件ID、主题、发件人和日期
   - 邮件内容预览和完整内容

## 故障排除

- **OAuth认证失败**：刷新令牌可能已过期。您需要重新获取有效的刷新令牌。
- **密码认证失败**：检查您的密码是否正确，或者账户是否启用了多因素认证（如果启用了MFA，请使用应用密码）。
- **无法连接到IMAP服务器**：检查您的网络连接和防火墙设置。
- **令牌刷新失败**：检查client_id是否正确，或者刷新令牌是否有效。

## 安全提示

- 不要在共享环境中使用此脚本，因为脚本中包含明文凭据。
- 考虑将凭据存储在环境变量或独立的配置文件中，而不是硬编码在脚本中。
- 定期更新您的密码和刷新令牌以提高安全性。 