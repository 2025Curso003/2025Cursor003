# Outlook IMAP 邮件获取工具

这个Python脚本使用IMAP协议从Outlook邮箱中获取最新的一封邮件。相比OAuth认证方式，IMAP方式更简单、直接，不需要复杂的应用注册和认证流程。

## 功能特点

- 使用IMAP协议直接访问Outlook邮箱
- 获取收件箱中最新的一封邮件
- 支持解析多种邮件格式（纯文本、HTML）
- 可选择是否将邮件标记为已读
- 安全的密码输入方式（不在屏幕上显示）
- 完整提取邮件主题、发件人、日期和正文内容

## 使用要求

1. Python 3.6 或更高版本
2. 标准库（无需安装额外依赖）
3. Outlook.com 或 Office 365 邮箱账号和密码

## 使用前准备

使用IMAP访问Outlook邮箱前，您需要在Outlook账户中启用IMAP访问：

1. 登录到 [Outlook.com](https://outlook.live.com/) 或 Office 365
2. 点击右上角齿轮图标，进入 "设置"
3. 搜索 "IMAP" 或依次点击 "查看所有Outlook设置" -> "邮件" -> "同步电子邮件"
4. 确保 "IMAP访问" 已启用

对于某些账户，您可能还需要：

1. 启用"应用密码"或"双因素身份验证"
2. 在安全性较低的应用访问设置中允许访问

## 使用方法

### 方式1：命令行参数

```bash
python outlook_imap.py <邮箱地址> <密码> [标记为已读]
```

例如：
```bash
python outlook_imap.py myemail@outlook.com mypassword123 true
```

### 方式2：交互式输入

直接运行脚本，然后按提示输入：

```bash
python outlook_imap.py
```

程序会提示您输入邮箱地址和密码。密码输入时不会显示在屏幕上，确保安全。

### 参数说明

- `<邮箱地址>`: 您的Outlook邮箱地址
- `<密码>`: 您的邮箱密码
- `[标记为已读]`: 可选参数，值为 true/false，表示是否将获取的邮件标记为已读

## 安全注意事项

1. 避免在共享脚本或代码版本控制系统中包含您的实际密码
2. 如果您的账户设置了多因素身份验证，可能需要创建"应用密码"而不是使用主密码
3. 确保您的计算机和网络环境安全

## 故障排除

### 登录失败

如果遇到登录错误，可能的原因包括：

1. 账户或密码不正确
2. 账户启用了双因素认证，但没有使用应用密码
3. IMAP访问未在Outlook设置中启用
4. 账户被暂时锁定（可能是因为多次登录失败）

建议：
- 检查您的邮箱地址和密码
- 确认IMAP访问已启用
- 如果启用了双因素认证，请使用应用密码
- 通过网页登录Outlook检查账户状态

### 无法获取邮件

如果登录成功但无法获取邮件，可能的原因包括：

1. 收件箱为空
2. 网络连接问题
3. 服务器暂时不可用

建议：
- 检查收件箱是否确实有邮件
- 确保网络连接稳定
- 稍后重试 